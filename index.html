<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
  </head>
  <body>
    <script>

      var index = 0;

      var checkNewTweets = function() {
        var numTweets = streams.home.length-1;
        if (numTweets > index) {
          numNew = numTweets - index;
          index = numTweets;
          console.log(numNew + ", " + index);
          return numNew;
        }
        return 0;
      };

      var updateTweets = function(numNew) {
        var toInsert = '';
        var head = streams.home.length-1;
        var i = 0;
        while(i < numNew){
          var tweet = streams.home[head - i];
          
          var text = '@' + tweet.user + " (" + tweet.created_at.getHours() + ":" + tweet.created_at.getMinutes() + ") " + ': ' + tweet.message;
          
          var $tweet = '<div class="tweet">' + text + '</div>';
          //$tweet.appendTo($('body'));
          toInsert += $tweet;
          i += 1;
        }
        $('body').prepend(toInsert);
      };

      var update = function() {
        updateTweets(checkNewTweets());
      };

      $(document).ready(function(){
        var $body = $('body');
        $body.html('');

        //index = checkNewTweets();

        //updateTweets(index);

        setInterval(update, 1000);
      });

    </script>
  </body>
</html>
