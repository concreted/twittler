<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
  </head>
  <body>
    <script>

      var totalTweets = 0;
      var numNew = 0;

      var checkNewTweets = function() {
        var numTweets = streams.home.length;
        
        numNew = numTweets - totalTweets;
        
        totalTweets = numTweets;
        
        if (numNew > 0)
          console.log(numNew + ", " + totalTweets);
      };

      var updateTweets = function() {
        var toInsert = '';
        var head = totalTweets - 1;
        var i = 0;
        while(i < numNew){
          var tweet = streams.home[head - i];

	  var timestamp = " (" + tweet.created_at.getHours() + ":" + tweet.created_at.getMinutes() + ")";          
	  var $timestamp = '<div class="timestamp">' + timestamp + '</div>';
		  
          var text = '@' + tweet.user + ': ' + tweet.message;
          var $tweetMsg = '<div class="tweet_msg">' + text + '</div>' + $timestamp;
		  
	  var $tweet = '<div class = "tweet">' + $tweetMsg + '</div>';
          toInsert += $tweet;
          i += 1;
        }
        $('body').prepend(toInsert);
      };

      var update = function() {
	checkNewTweets();
        updateTweets();
      };

      $(document).ready(function(){
        var $body = $('body');
        $body.html('');

        setInterval(update, 1000);
      });

    </script>
  </body>
</html>
